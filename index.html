<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Busca MTG</title>
</head>

<body style="background-color:darkslategray">
    <br>
    <input class="checkbox" type="checkbox" id="pirulo" name="pirulo" checked>
    <label class="label" for="pirulo">pirulo</label>
    <input class="checkbox" type="checkbox" id="mercadia" name="mercadia" checked>
    <label class="label" for="mercadia">mercadia</label>
    <input class="checkbox" type="checkbox" id="magicLair" name="magicLair" checked>
    <label class="label" for="magicLair">magicLair</label>
    <input class="checkbox" type="checkbox" id="batikueva" name="batikueva" checked>
    <label class="label" for="batikueva">batikueva</label>
    <input class="checkbox" type="checkbox" id="scryfall" name="scryfall" checked>
    <label class="label" for="scryfall">scryfall</label>
    <br>
    <p class="p">Escribí la carta en inglés</p>
    <input class="inputText" id="input" type="text" placeholder="Escribí bien...">
    <button class="button" id="submit" type="submit" onclick="abrir()">Buscar</button>
    <br>
    <label class="p" for="deckList">Pegá tu deck (sin secciones como: //Main o //Sideboard)</label>
    <br>
    <textarea class="textarea" id="deckList" name="deckList" rows="4" cols="100"></textarea> 
    <br>
    <button class="button" id="submit" type="submit" onclick="handleBuscarDeck()">Buscar Deck</button>
    <p>this is not a serious project</p>
</body>
<script>
    const stores = [];
    document.querySelectorAll("input").forEach((documento) => {
        if (documento.getAttribute("name")) {
            stores.push(documento.getAttribute("name"))
        }
    })
    const input = document.getElementById("input");
    input.addEventListener("keyup", function (event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            document.getElementById("submit").click();
        }
    });
    function handleBuscarDeck() {
        const cardListArray = document.getElementById("deckList").value.replace(/(\d+)(.)/g, '').split('\n')
        cardListArray.forEach((card) => {
            const cardToQuery = card.replace(/(\s)/g, '+')
            const storesURL = {
                pirulo: `https://www.mtgpirulo.com/products/search?q=${cardToQuery}&c=1`,
                mercadia: `https://mercadiacity.com/index.php/catalogsearch/result/?q=${cardToQuery}`,
                magicLair: `https://www.magiclair.com.ar/productos.html?viene=&search=${cardToQuery}`,
                batikueva: `https://www.labatikuevastore.com/search/?q=${cardToQuery}`,
                scryfall: `https://scryfall.com/search?q=${cardToQuery}&unique=cards&as=grid&order=name`,
            }
            stores.forEach((store) => {
                if (document.querySelector(`[name = ${store}]`).checked) {
                    window.open(storesURL[store]);
                }
            })
        })
    }
    function abrir() {
        let cardName = document.getElementById('input').value.replace(/(\d+)(.)/g, '');
        if (cardName.split('').length > 1) {
            cardName = cardName.split(' ').join('+');
        }
        const storesURL = {
            pirulo: `https://www.mtgpirulo.com/products/search?q=${cardName}&c=1`,
            mercadia: `https://mercadiacity.com/index.php/catalogsearch/result/?q=${cardName}`,
            magicLair: `https://www.magiclair.com.ar/productos.html?viene=&search=${cardName}`,
            batikueva: `https://www.labatikuevastore.com/search/?q=${cardName}`,
            scryfall: `https://scryfall.com/search?q=${cardName}&unique=cards&as=grid&order=name`,
        }
        stores.forEach((store) => {
            if (document.querySelector(`[name = ${store}]`).checked) {
                window.open(storesURL[store]);
            }
        })
    }
</script>
<style>
    .p {
        font-size: 40px;
        color: white;
    }

    .inputText {
        width: 90%;
        height: 90px;
        font-size: 70px;
    }

    .checkbox {
        margin-top: 30px;
        height: 35px;
        width: 35px;
    }

    .label {
        color: white;
        font-size: 40px;
    }

    .button {
        width: 13%;
        height: 60px;
        font-size: 30px;
        margin-left: 5%;
        margin-top: 30px;
    }

    .textarea {
        height: 250px;
    }
</style>

</html>